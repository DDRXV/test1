export type FunnelData = {
  Date: string;
  Stage: string;
  Users: number;
  Conversion_Rate: number;
  Revenue_USD: number;
  Gateway_A_Success_Rate: number;
  Gateway_B_Success_Rate: number;
  Gateway_C_Success_Rate: number;
  Average_Processing_Time_Seconds: number;
  User_Satisfaction_Score: number;
  Failed_Transactions: number;
  Successful_Transactions: number;
};

export const funnelData: FunnelData[] = [
  {
    Date: "2025-01-01",
    Stage: "Awareness",
    Users: 15000,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-01",
    Stage: "Interest",
    Users: 8500,
    Conversion_Rate: 56.7,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-01",
    Stage: "Consideration",
    Users: 4200,
    Conversion_Rate: 49.4,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-01",
    Stage: "Trial",
    Users: 2100,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.5,
    Gateway_B_Success_Rate: 87.2,
    Gateway_C_Success_Rate: 89.8,
    Average_Processing_Time_Seconds: 2.3,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-01",
    Stage: "Activation",
    Users: 1680,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 93.1,
    Gateway_B_Success_Rate: 88.5,
    Gateway_C_Success_Rate: 90.2,
    Average_Processing_Time_Seconds: 2.1,
    User_Satisfaction_Score: 4.2,
    Failed_Transactions: 67,
    Successful_Transactions: 1613
  },
  {
    Date: "2025-01-01",
    Stage: "Purchase",
    Users: 1260,
    Conversion_Rate: 75.0,
    Revenue_USD: 63000,
    Gateway_A_Success_Rate: 94.2,
    Gateway_B_Success_Rate: 89.1,
    Gateway_C_Success_Rate: 91.0,
    Average_Processing_Time_Seconds: 2.0,
    User_Satisfaction_Score: 4.5,
    Failed_Transactions: 95,
    Successful_Transactions: 1165
  },
  {
    Date: "2025-01-02",
    Stage: "Awareness",
    Users: 16200,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-02",
    Stage: "Interest",
    Users: 9400,
    Conversion_Rate: 58.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-02",
    Stage: "Consideration",
    Users: 4700,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-02",
    Stage: "Trial",
    Users: 2350,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.8,
    Gateway_B_Success_Rate: 87.5,
    Gateway_C_Success_Rate: 90.1,
    Average_Processing_Time_Seconds: 2.2,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-02",
    Stage: "Activation",
    Users: 1880,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 93.4,
    Gateway_B_Success_Rate: 88.7,
    Gateway_C_Success_Rate: 90.5,
    Average_Processing_Time_Seconds: 2.0,
    User_Satisfaction_Score: 4.3,
    Failed_Transactions: 75,
    Successful_Transactions: 1805
  },
  {
    Date: "2025-01-02",
    Stage: "Purchase",
    Users: 1410,
    Conversion_Rate: 75.0,
    Revenue_USD: 70500,
    Gateway_A_Success_Rate: 94.5,
    Gateway_B_Success_Rate: 89.3,
    Gateway_C_Success_Rate: 91.2,
    Average_Processing_Time_Seconds: 1.9,
    User_Satisfaction_Score: 4.6,
    Failed_Transactions: 106,
    Successful_Transactions: 1304
  },
  {
    Date: "2025-01-03",
    Stage: "Awareness",
    Users: 14500,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-03",
    Stage: "Interest",
    Users: 8100,
    Conversion_Rate: 55.9,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-03",
    Stage: "Consideration",
    Users: 4050,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-03",
    Stage: "Trial",
    Users: 2025,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.3,
    Gateway_B_Success_Rate: 87.0,
    Gateway_C_Success_Rate: 89.6,
    Average_Processing_Time_Seconds: 2.4,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-03",
    Stage: "Activation",
    Users: 1620,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.9,
    Gateway_B_Success_Rate: 88.2,
    Gateway_C_Success_Rate: 90.0,
    Average_Processing_Time_Seconds: 2.2,
    User_Satisfaction_Score: 4.1,
    Failed_Transactions: 65,
    Successful_Transactions: 1555
  },
  {
    Date: "2025-01-03",
    Stage: "Purchase",
    Users: 1215,
    Conversion_Rate: 75.0,
    Revenue_USD: 60750,
    Gateway_A_Success_Rate: 94.0,
    Gateway_B_Success_Rate: 88.9,
    Gateway_C_Success_Rate: 90.8,
    Average_Processing_Time_Seconds: 2.1,
    User_Satisfaction_Score: 4.4,
    Failed_Transactions: 91,
    Successful_Transactions: 1124
  },
  {
    Date: "2025-01-04",
    Stage: "Awareness",
    Users: 13800,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-04",
    Stage: "Interest",
    Users: 7700,
    Conversion_Rate: 55.8,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-04",
    Stage: "Consideration",
    Users: 3850,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-04",
    Stage: "Trial",
    Users: 1925,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.0,
    Gateway_B_Success_Rate: 86.8,
    Gateway_C_Success_Rate: 89.4,
    Average_Processing_Time_Seconds: 2.5,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-04",
    Stage: "Activation",
    Users: 1540,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.7,
    Gateway_B_Success_Rate: 88.0,
    Gateway_C_Success_Rate: 89.8,
    Average_Processing_Time_Seconds: 2.3,
    User_Satisfaction_Score: 4.0,
    Failed_Transactions: 62,
    Successful_Transactions: 1478
  },
  {
    Date: "2025-01-04",
    Stage: "Purchase",
    Users: 1155,
    Conversion_Rate: 75.0,
    Revenue_USD: 57750,
    Gateway_A_Success_Rate: 93.8,
    Gateway_B_Success_Rate: 88.7,
    Gateway_C_Success_Rate: 90.6,
    Average_Processing_Time_Seconds: 2.2,
    User_Satisfaction_Score: 4.3,
    Failed_Transactions: 87,
    Successful_Transactions: 1068
  },
  {
    Date: "2025-01-05",
    Stage: "Awareness",
    Users: 17500,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-05",
    Stage: "Interest",
    Users: 10150,
    Conversion_Rate: 58.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-05",
    Stage: "Consideration",
    Users: 5075,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-05",
    Stage: "Trial",
    Users: 2538,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 93.0,
    Gateway_B_Success_Rate: 87.8,
    Gateway_C_Success_Rate: 90.3,
    Average_Processing_Time_Seconds: 2.1,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-05",
    Stage: "Activation",
    Users: 2030,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 93.6,
    Gateway_B_Success_Rate: 88.9,
    Gateway_C_Success_Rate: 90.7,
    Average_Processing_Time_Seconds: 1.9,
    User_Satisfaction_Score: 4.4,
    Failed_Transactions: 81,
    Successful_Transactions: 1949
  },
  {
    Date: "2025-01-05",
    Stage: "Purchase",
    Users: 1523,
    Conversion_Rate: 75.0,
    Revenue_USD: 76150,
    Gateway_A_Success_Rate: 94.7,
    Gateway_B_Success_Rate: 89.5,
    Gateway_C_Success_Rate: 91.4,
    Average_Processing_Time_Seconds: 1.8,
    User_Satisfaction_Score: 4.7,
    Failed_Transactions: 114,
    Successful_Transactions: 1409
  },
  {
    Date: "2025-01-06",
    Stage: "Awareness",
    Users: 16800,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-06",
    Stage: "Interest",
    Users: 9750,
    Conversion_Rate: 58.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-06",
    Stage: "Consideration",
    Users: 4875,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-06",
    Stage: "Trial",
    Users: 2438,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.9,
    Gateway_B_Success_Rate: 87.7,
    Gateway_C_Success_Rate: 90.2,
    Average_Processing_Time_Seconds: 2.2,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-06",
    Stage: "Activation",
    Users: 1950,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 93.5,
    Gateway_B_Success_Rate: 88.8,
    Gateway_C_Success_Rate: 90.6,
    Average_Processing_Time_Seconds: 2.0,
    User_Satisfaction_Score: 4.3,
    Failed_Transactions: 78,
    Successful_Transactions: 1872
  },
  {
    Date: "2025-01-06",
    Stage: "Purchase",
    Users: 1463,
    Conversion_Rate: 75.0,
    Revenue_USD: 73150,
    Gateway_A_Success_Rate: 94.6,
    Gateway_B_Success_Rate: 89.4,
    Gateway_C_Success_Rate: 91.3,
    Average_Processing_Time_Seconds: 1.9,
    User_Satisfaction_Score: 4.6,
    Failed_Transactions: 110,
    Successful_Transactions: 1353
  },
  {
    Date: "2025-01-07",
    Stage: "Awareness",
    Users: 15500,
    Conversion_Rate: 100.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-07",
    Stage: "Interest",
    Users: 8850,
    Conversion_Rate: 57.1,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-07",
    Stage: "Consideration",
    Users: 4425,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 0,
    Gateway_B_Success_Rate: 0,
    Gateway_C_Success_Rate: 0,
    Average_Processing_Time_Seconds: 0,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-07",
    Stage: "Trial",
    Users: 2213,
    Conversion_Rate: 50.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 92.6,
    Gateway_B_Success_Rate: 87.3,
    Gateway_C_Success_Rate: 89.9,
    Average_Processing_Time_Seconds: 2.3,
    User_Satisfaction_Score: 0,
    Failed_Transactions: 0,
    Successful_Transactions: 0
  },
  {
    Date: "2025-01-07",
    Stage: "Activation",
    Users: 1770,
    Conversion_Rate: 80.0,
    Revenue_USD: 0,
    Gateway_A_Success_Rate: 93.2,
    Gateway_B_Success_Rate: 88.4,
    Gateway_C_Success_Rate: 90.3,
    Average_Processing_Time_Seconds: 2.1,
    User_Satisfaction_Score: 4.2,
    Failed_Transactions: 71,
    Successful_Transactions: 1699
  },
  {
    Date: "2025-01-07",
    Stage: "Purchase",
    Users: 1328,
    Conversion_Rate: 75.0,
    Revenue_USD: 66400,
    Gateway_A_Success_Rate: 94.3,
    Gateway_B_Success_Rate: 89.0,
    Gateway_C_Success_Rate: 91.1,
    Average_Processing_Time_Seconds: 2.0,
    User_Satisfaction_Score: 4.5,
    Failed_Transactions: 100,
    Successful_Transactions: 1228
  }
];

export const getUniqueStages = () => {
  const stages = new Set<string>();
  funnelData.forEach(item => stages.add(item.Stage));
  return Array.from(stages);
};

export const getUniqueDates = () => {
  const dates = new Set<string>();
  funnelData.forEach(item => dates.add(item.Date));
  return Array.from(dates).sort();
};

export const getFunnelDataByDate = (date: string) => {
  return funnelData.filter(item => item.Date === date);
};

export const getLatestDate = () => {
  const dates = getUniqueDates();
  return dates[dates.length - 1];
};

export const getPreviousDate = (date: string) => {
  const dates = getUniqueDates();
  const currentIndex = dates.indexOf(date);
  if (currentIndex > 0) {
    return dates[currentIndex - 1];
  }
  return date;
};

export const getStageData = (stage: string) => {
  return funnelData.filter(item => item.Stage === stage);
};

export const getGatewayData = (date: string) => {
  const data = getFunnelDataByDate(date);
  return data.filter(item => item.Gateway_A_Success_Rate > 0);
};

export const getSatisfactionData = (date: string) => {
  const data = getFunnelDataByDate(date);
  return data.filter(item => item.User_Satisfaction_Score > 0);
};

export const getRevenueData = () => {
  return funnelData.filter(item => item.Revenue_USD > 0);
};

export const getTotalUsers = (date: string) => {
  const data = getFunnelDataByDate(date);
  const awarenessData = data.find(item => item.Stage === "Awareness");
  return awarenessData ? awarenessData.Users : 0;
};

export const getTotalRevenue = (date: string) => {
  const data = getFunnelDataByDate(date);
  return data.reduce((sum, item) => sum + item.Revenue_USD, 0);
};

export const getOverallConversionRate = (date: string) => {
  const data = getFunnelDataByDate(date);
  const awareness = data.find(item => item.Stage === "Awareness");
  const purchase = data.find(item => item.Stage === "Purchase");
  
  if (awareness && purchase && awareness.Users > 0) {
    return (purchase.Users / awareness.Users) * 100;
  }
  return 0;
};

export const getAverageProcessingTime = (date: string) => {
  const data = getGatewayData(date);
  if (data.length === 0) return 0;
  
  return data.reduce((sum, item) => sum + item.Average_Processing_Time_Seconds, 0) / data.length;
};

export const getAverageSatisfactionScore = (date: string) => {
  const data = getSatisfactionData(date);
  if (data.length === 0) return 0;
  
  return data.reduce((sum, item) => sum + item.User_Satisfaction_Score, 0) / data.length;
};

export const getTotalTransactions = (date: string) => {
  const data = getFunnelDataByDate(date);
  return data.reduce((sum, item) => sum + item.Successful_Transactions + item.Failed_Transactions, 0);
};

export const getFailedTransactions = (date: string) => {
  const data = getFunnelDataByDate(date);
  return data.reduce((sum, item) => sum + item.Failed_Transactions, 0);
};

export const getSuccessfulTransactions = (date: string) => {
  const data = getFunnelDataByDate(date);
  return data.reduce((sum, item) => sum + item.Successful_Transactions, 0);
};

export const getTransactionSuccessRate = (date: string) => {
  const total = getTotalTransactions(date);
  const successful = getSuccessfulTransactions(date);
  
  if (total > 0) {
    return (successful / total) * 100;
  }
  return 0;
};
